<!doctype html>
<html lang="pt-BR">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Painel da Organizadora — Confra Família 2025</title>
<link rel="stylesheet" href="style.css"/>
</head>
<body>
<canvas id="fw" class="fw" aria-hidden="true"></canvas>
<div class="card">
  <img src="DD6B87E9-1FEE-43C9-A4FD-0C3350367ECB.jpeg" class="logoimg" alt="Logo">
  <h2>Painel da Organizadora (local)</h2>
  <button id="load" class="bigbtn">Carregar dados locais</button>
  <button id="export" class="bigbtn outline">Exportar CSV</button>
  <h3>Participantes</h3>
  <ul id="parts" class="list"></ul>
  <h3>Itens restantes</h3>
  <ul id="rest" class="list"></ul>
</div>
<script>
function load(k){return JSON.parse(localStorage.getItem(k)||'null');}
document.getElementById('load').addEventListener('click', ()=>{
  const parts = load('participants')||[];
  const restos = load('restos')|| null;
  const lp = document.getElementById('parts'); lp.innerHTML=''; parts.forEach(p=>{ const li=document.createElement('li'); li.textContent = p.nome + ' — ' + p.pwd + ' — ' + p.item; lp.appendChild(li); });
  const lr = document.getElementById('rest'); lr.innerHTML=''; (restos||ITEMS).forEach(i=>{ const li=document.createElement('li'); li.textContent = i; lr.appendChild(li); });
});
document.getElementById('export').addEventListener('click', ()=>{
  const parts = load('participants')||[];
  let csv = 'nome,senha,item,timestamp\n';
  parts.forEach(p=> csv += `"${p.nome.replace(/"/g,'""')}","${p.pwd.replace(/"/g,'""')}","${p.item.replace(/"/g,'""')}","${p.ts}"\n`);
  const blob = new Blob([csv], {type:'text/csv'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='participantes.csv'; a.click(); URL.revokeObjectURL(url);
});
</script>
</body>
</html>
